Most early studies about dynamic stall consider airfoils describing a pitching motion, i.e. the evolution of the angle of attack in time is a sinusoidal curve and the hinge is at the quarter chord. The reason this is the application to helicopters, where a forward motion makes the blades undergo a sinusoidally varying angle of attack. However, the influence of the unsteadiness is easier to asses when the pitching velocity is constant. That lead the present study to use ramp-up motions, i.e. the evolution of the angle of attack in time is a ramp. 

\section{Static characteristics}

The dynamic stall properties are best defined as the sum of static stall properties and a correction due to the unsteady motion. Following this approach, it is then obvious that in order to have a accurate prediction for the dynamic loads, the static data must be reliable. 

\subsection{NACA0012}

The NACA0012 airfoil has been repeatedly taken as an example for dynamic stall studies. Indeed, in Beddoes work (\cite{beddoes_representation_1983}, \cite{leishman_semi-empirical_1989}) NACA 0012 alongside with NACA 23012 was chosen. In Sheng's work (\cite{sheng_new_2006}, \cite{sheng_improved_2007}), several airfoils are compared but the NACA 0012 is always present.

A good explanation of the difficulties encountered when determining the static properties of the airfoil NACA 0012 at moderate Reynolds number (Re between $10^4$ and $10^5$) is given in \cite{tank_possibility_2017}.

\begin{wrapfigure}{r}{10cm}
\centering
\includegraphics[width=10cm]{static_naca0012.png}
\caption{Normal coefficient curve for airfoil NACA0012, in steady-state from angles of attack from $\alpha=-5 \deg$ to $17 \deg$}
\label{fig:static_flatplate}
\end{wrapfigure}


\subsection{OA209}

The ONERA OA209 airfoil was used in \cite{mulleners_onset_2010}. This airfoil exhibits smooth stall properties, caused by progressive trailing edge separation.

\begin{wrapfigure}{r}{10cm}
\centering
\includegraphics[width=10cm]{static_OA209.png}
\caption{Normal coefficient curve for airfoil OA209, in steady-state from angles of attack from $\alpha=3 \deg$ to $24 \deg$}
\label{fig:static_flatplate}
\end{wrapfigure}

\subsection{Modified flatplate airfoil}

The static properties of the modified flatplate airfoil were determined experimentally. The load cell was calibrated with no inflow velocity to compensate for the load cell offset, inertial and  buoyancy forces. The calibration test was run for 10s and the signal was averaged to a single calibration value for each axis. This value is then subtracted from the signals during experiments. The calibration procedure is repeated every day so that the calibration values are valid only on the same day, as external perturbations such as atmospheric pressure might change from one day to another. 

After calibration was done, the static loads were measured at $Re=7.5\cdot10^4$. The measurements were taken from an angle of attack eof $-5 \deg$ to $30 \deg$ with a step of $1 \deg$ in between measurement point. The signal coming from the load cell was average for 10s in order to yield a single force at each pitch position. The series was repeated five times and the normal coefficient value was then averaged to a single one for each angle of attack. 

\begin{wrapfigure}{r}{10cm}
\centering
\includegraphics[width=10cm]{static_flatplate.png}
\caption{Normal coefficient curve for the modified flat plate airfoil, in steady-state from angles of attack from $\alpha=-5 \deg$ to $30 \deg$}
\label{fig:static_flatplate}
\end{wrapfigure}

\subsection{Modelling of the static charateristics}
\label{section:kirchhoff}

% see p. 10 of Beddoes 1983
Beddoes introduced in \cite{beddoes_representation_1983} what he called the \textit{Kirchhoff flow approximation}. This model gave a relationship for the angle of attack, the separation point and the normal coefficient.

The separation point is described as a function of the angle of attack $\alpha$ by the following expression : 

\begin{equation}
	f(\alpha) = 
		\begin{cases}
		1-0.3\exp(\frac{\alpha-\alpha_{ss}}{S_1}), &\quad \alpha \leq \alpha_{ss}\\
		0.04+0.66\exp(\frac{\alpha_{ss}-\alpha}{S_2}). &\quad \alpha > \alpha_{ss}\\
		\end{cases}
	\label{eq:seppoint}
\end{equation}

\noindent $S_1$ and $S_2$ are fitting parameters that characterize the abruptness of the stall. These parameters are optimized for the normal coefficient given by the Kirchhoff model (described in Eq. \eqref{eq:k irchhoff} using the result of Eq. \eqref{eq:seppoint} as an argument. This modelled $C_N$ is finally fitted to the experiment normal coefficient in a least squares sense thanks to the Matlab command \texttt{lsqcurvefit}.

Originally, $\alpha_{ss}$ in Eq. \ref{eq:seppoint} is denoted by $\alpha_1$ and is added to the paramteres to be optimized. However, this parameter is often found to be very close to the static stall angle $\alpha_ss$. As a result, it was replaced by the experimentally observed static stall angle. 

The approximation for the normal coefficient as a function of the boundary layer separation location and $\alpha$ is the following: 

\begin{equation}
	C_N (\alpha) = C_ {N_{\alpha}} \left(\frac{1+\sqrt{f}}{2}\right)^2 \alpha
	\label{eq:kirchhoff}
\end{equation}

\noindent where $C_{N_\alpha}$ is the static lift curve slope in the pre-stall regime. This model can sometimes be problematic, as discussed in section \ref{LSB}.

\iffalse
\begin{tikzpicture}[
	nonterminal/.style={
		% The shape:
		rectangle,
		% The size:
		minimumsize=6mm,
		% The border: 
		very thick,
		draw=black,
		% The filling:
		color=white,						
	}]
	\node [nonterminal] {\alpha}
\end{tikzpicture}
\fi

\section{Dynamic stall model}

\subsection{Beddoes-Leishman model}

The original Beddoes-Leishman is best explained in \autocite{tank_possibility_2017}. However, for the convenience of referring to equation numbers in the following sections, a brief overview is provided in this one. 

\subsubsection{Attached flow behavior}

The attached regime is defined as the angles of attack for which the boundary layer follows the airfoil curvature without exhibiting separation, typically between -10 and 10 degrees. The force under this conditions is a linear function of the angle of attack and is the sum of two components, the circulatory and the impulsive lift: 

\begin{equation}
C_N = C_N^C + C_N^I
\end{equation}

\noindent where the circulatory force is related to the added circulation due to a sudden deflection

\begin{equation}
C_N^C = C_{N_\alpha} \alpha_{E}
\label{eq:circulatory}
\end{equation}

\noindent where $C_{N_\alpha}$ is the slope of the $C_N(\alpha)$ polar curve in the pre-stall regime and with the effective angle of attack $\alpha_E = \alpha - X - Y$, where $X$, $Y$ are deficiency functions obtained with a mid-point approximation of the Duhamel's integral, as explained in \autocite{leishman_principles_2000}:

\begin{eqnarray}{l}
X(n)= & X(n-1) \exp \left(-b_{1} \beta^{2} \Delta S\right)+A_{1} \Delta \alpha \exp \left(-b_{1} \beta^{2} \Delta S / 2\right) \\
Y(n)= & Y(n-1) \exp \left(-b_{2} \beta^{2} \Delta S\right)+A_{2} \Delta \alpha \exp \left(-b_{2} \beta^{2} \Delta S / 2\right)
\end{eqnarray}

\begin{equation}
C_{N}^{I}=\frac{4 K_{\alpha} T_{l}}{M}\left(\frac{\Delta \alpha}{\Delta t}-D\right)
\label{eq:impulsive}
\end{equation}

 The impulsive term corresponds to the pressure difference caused by the mass displacement. It is also called \texttt{added mass} in an aeroelasticity context.

\subsubsection{Leading edge separation}

\begin{equation}
\frac{C_N^{\prime}(s)}{C_N(s)} = \frac{1}{1+T_p s}
\label{•}  
\end{equation}

\begin{equation}
\alpha_f = \frac{C_N^{\prime}}{C_{N_\alpha}}
\label{eq:equivalent_alpha}
\end{equation}

\subsubsection{Trailing edge separation}
As the angle of attack increases, stall is approached. Depending on the airfoil shape, stall can occur through progressive separation of the boundary layer from the trailing edge towards the fore. This phenomenon can be modeled thanks to the equations presented in this section. 
The position of the boundary layer separation $f$ is a function of the angle of attack, and the relation between the two is usually difficult to find experimentally. However, Beddoes suggests in \autocite{beddoes_representation_1983} to model $f(\alpha)$ using the following relationship:

\begin{equation}
f(\alpha)=\left\{\begin{array}{ll}
1-0.3 \exp \left(\frac{\alpha-\alpha_{ss}}{S_{1}}\right), & \alpha \leq \alpha_{ss} \\
0.04+0.66 \exp \left(\frac{\alpha_{ss}-\alpha}{S_{2}}\right), & \alpha >\alpha_{ss}
\end{array}\right.
\label{eq:seppoint}
\end{equation}

In Eq. \eqref{eq:seppoint}, $S_1$ and $S_2$ are constants controlling the abruptness of stall. They are optimized in a least-square sense so that the experimental static normal coefficient is as close as possible to the one computed using Kirchhoff model, i.e. Eq. \eqref{eq:seppoint} \& \eqref{eq:kirchhoff}. 

\begin{equation}
C_{N} = C_{N_{\alpha}}\left(\frac{1+\sqrt{f}}{2}\right)^{2} \alpha_{E}+C_{N}^{I}
\label{eq:kirchhoff}
\end{equation}

$S1$ and $S2$ are then reused to compute the delayed separation point $f^{\prime}$ from the efficient angle of attack $\alpha_f$:

\begin{equation}
f^{\prime}(\alpha)=\left\{\begin{array}{ll}
1-0.3 \exp \left(\frac{\alpha_{f}-\alpha_{ss}}{S_{1}}\right), & \alpha_{f} \leq \alpha_{ss} \\
0.04+0.66 \exp \left(\frac{\alpha_{ss}-\alpha_{f}}{S_{2}}\right), & \alpha_{f}>\alpha_{ss}
\end{array}\right.
\end{equation}

A first order lag is then applied to $f^{\prime}$ to compute $f^{\prime}$ via $T_f$. 

\begin{equation}
\frac{f^{\prime \prime (s)}}{f^{\prime} (s)} = \frac{1}{1 + T_f s}
\label{•}
\end{equation}

And the modified-Kirchhoff normal coefficient is computed using Kirchhoff relationship \eqref{eq:kirchoff} applied to $f^{\prime \prime}$. 

\begin{equation}
	C_{N}^{f}=C_{N_{\alpha}}\left(\frac{1+\sqrt{f^{\prime \prime}}}{2}\right)^{2} \alpha_{E}+C_{N}^{I}\label{eq:mod_kirchoff}
\end{equation}

\subsubsection{Dynamic stall and vortex shedding}


\subsection{Sheng criterion}

Sheng defines the lagged angle of attack, $\alpha'$ as

\begin{equation}
\Delta \alpha' = \Delta \alpha\left[1-e^{-t_c/T_\alpha} \right]
\label{eq:alpha_lag}
\end{equation}

\noindent with $t_c=tc/U_{\infty}$, the convective time, and the stall criterion for an airfoil in ramp-up motion as 

\begin{equation}
\alpha' > \alpha_{crit}
\label{eq:stall_criterion}
\end{equation}

In Sheng's article, $\alpha_{crit}$ varies with $r$. 

\begin{equation}
\alpha_{crit} =
\begin{cases}
\alpha_{ds0}, &\quad \text{if} r \geq r_0 \\
\alpha_{ds0} + (\alpha_{ds0}-\alpha_{ss}) \frac{r}{r_0}, &\quad \text{if} r < r_0 \\
\end{cases}
\end{equation}

\noindent with $r_0$ generally around 0.01.

\subsection{Modified Sheng Criterion}

The time at static stall angle $t_{ss}$ is defined as the time $t$ at which the airfoil passes the static stall angle $\alpha_{ss}$.

\begin{equation}
\alpha_{ss} = \alpha(t_{ss})
\end{equation}

\begin{equation}
t_{ds} = t_{ss} +  \Delta t_1 + \Delta t_2
\end{equation}

\begin{equation}
\alpha_{ds} = \alpha(t_{ds})
\end{equation}

\subsubsection{Exponential fit of the dynamic stall angle}

In \autocite{sheng_new_2006},  Sheng et al. define $\alpha_{crit}$ equal to  $\alpha_{ds,0}$, the y-intercept of the linear fitting of $\alpha_{ds}(r)$. They then define a  $T_\alpha$ constant with respect to the reduced pitch rate $r$ from the slope of the linear fitting. However, it has been noticed that the range of validity of this hypothesis is restrained to $0.01<r<0.05$. Our goal in allowing $T_\alpha$ to vary with $r$ is to improve the range of validity of the stall prediction method. 

\begin{figure}[h]
\centering
\includegraphics[width=.7\textwidth]{Sheng/alphads_r.png} 
\caption{Evolution of the stall angle and the lagged stall angle with the reduced pitch rate for a flat plate airfoil}
\label{fig:alphads_r}
\end{figure}

It has been seen from ramp-up experiments that the dynamic stall angle increases a lot with an increase in $r$ at small $r$ and only a little with $\Delta r$ at higher $r$. It even becomes constant at high $r$, as shown in Figure \ref{fig:alphads_r}. based on this observation, we use an exponential fit to identify the dependency between the dynamic stall angle $\alpha_{ds}$ and $r$ of the form: 

\begin{equation}
\alpha_{ds}(r) = A-(A-\alpha_{ss})e^{-Br} = A(1-e^{-Br})+\alpha_{ss}e^{-Br}
\label{eq:alpha_ds_r}
\end{equation}

\noindent where the value of $A$ defines the plateau ($r \rightarrow \infty$) and the limit as $r \rightarrow 0$ is equal to $\alpha_{ss}$. $B$ is the rate of increase in between these two limits. The main remaining challenge now is to find a way to express $T_\alpha$ as a function of $r$ from these two coefficients $A$ and $B$.

\subsubsection{Expression for the delay time constant}

% TODO: This is not the case anymore since alpha_crit is not the same for Sheng's model and mine
In order to be a good generalization of Sheng's original method, the new $T_\alpha$ needs to take the value predicted by Sheng somewhere in the range of validity $0.01<r<0.05$. For the given example, this means $T_\alpha$ should pass around  4.6 in this range.
We know from the section about first order LTI systems that if the ideal angle of attack describes a motion such that 

 
\begin{equation}
\alpha(t) = \alphadot(t-t_0)
\end{equation}

\noindent then the lagged angle attack will be of the form:

\begin{equation}
\alpha'(t) = \alphadot\left[t- \tau(1-e^{-t/ \tau})\right]
\end{equation}

\noindent $\tau$ being the equivalent of $T_\alpha$ but in time domain. In other words, $T_\alpha = \frac{\tau c}{2U_\infty}$.

Evaluating this function at $t=t_{ds}$ and remembering the stall criterion presented in Equation \eqref{eq:stall_criterion}, we obtain : 

\begin{equation}
\alpha'(t_{ds}) = \alphadot\left[t_{ds} - \tau(1-e^{-t_{ds} / \tau})\right] = \alpha_{ss}
\label{eq:alpha_ds_tau}
\end{equation}

This equation can be solved for $\tau$ if the static properties of the airfoil and the time of dynamic stall $t_{ds}$ are known.

\subsubsection{Algorithm for pitch-rate-dependent time constant}

\begin{enumerate}
\item An airfoil with chord $c$ and known static stall angle $\alpha_{ss}$ is chosen for the experiment. 
\item The ramp-up motion is started with a defined $\alphadot$ and $r$.
\item The stall onset angle is predicted using $r$ and Equation \eqref{eq:alpha_ds_r}. From there the time of dynamic stall $t_ds$ is predicted using $\alphadot$.
\item $T_\alpha$ is computed by solving Equation  \eqref{eq:alpha_ds_tau} for $\tau$. $\alpha'$ is computed in real time using this result. 
\item When $\alpha' > \alpha_{crit}$, the stall criterion is attained and dynamic stall can be considered to have started. 
\end{enumerate}

\subsubsection{Modified Beddoes-Leishman}

Once $\alpha'$ has been obtained through the above-described procedure, it can be used to define the delayed separation point $f'$ in Beddoes-Leishman model.   

\subsection{Switching model}

All models up to now were based on a superposition of different components to normal force. It is therefore interesting to look at the performances of a model based on a switching between submodels. The switch would be triggered by the attainment of the stall and reattachment criterion.